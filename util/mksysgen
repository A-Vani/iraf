#!/bin/csh -f
#

if (! $?iraf) then
    #echo ""
    #echo "Error:  You must have the iraf env variable defined !"
    #echo ""
    #exit 1

    set  iraf 	= $cwd/
endif

env | sort
pwd

alias NOTE 'echo XXXXXXXXXX;echo XXXXXXXXXX;echo XXXXXXXXXX; echo util/mksysgen stage \!* '

set  c_start	= `date`
/bin/rm -f spool */spool


NOTE mkclean

$iraf/util/mkclean				# clean old binaries

NOTE mkpkg.sh

cd $iraf/unix					# NOVOS bootstrap
source hlib/irafuser.csh
sh -x mkpkg.sh |& tee log.040.NOVOS-boot

if ( "$sm_logs" != "" ) cp log.040.NOVOS-boot $sm_logs


NOTE mklibs

cd $iraf/vendor					# UR: build libs in vendor/
./mklibs |& tee log.050.vendor

if ( "$sm_logs" != "" ) cp log.050.vendor $sm_logs

NOTE mkpkg

cd $iraf/					# build NOVOS

env | sort
pwd

mkpkg |& tee log.060.NOVOS

if ( "$sm_logs" != "" ) cp log.060.NOVOS $sm_logs

NOTE mkpkg.sh again

cd $iraf/unix					# VOS bootstrap
source hlib/irafuser.csh
sh -x mkpkg.sh |& tee log.070.VOS

if ( "$sm_logs" != "" ) cp log.070.VOS $sm_logs

NOTE mkpkg again

cd $iraf/					# build core system
mkpkg |& tee log.080.core

if ( "$sm_logs" != "" ) cp log.080.core $sm_logs

NOTE noao

cd $iraf/noao					# build NOAO package
setenv noao $cwd/
mkpkg -p noao |& tee log.090.noao

if ( "$sm_logs" != "" ) cp log.090.noao $sm_logs

NOTE vo

cd $iraf/vo					# build VO package
setenv vo $cwd/
mkpkg -p vo |& tee log.100.vo

if ( "$sm_logs" != "" ) cp log.100.vo $sm_logs

NOTE 'end'

set  c_end	= `date`


echo ""
echo ""
echo ""
echo "Start:  $c_start"
echo "  End:  $c_end"
